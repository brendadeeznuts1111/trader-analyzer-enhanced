name = "trader-analyzer-markets"
main = "markets-simple.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

[build]
command = "bun build ./markets-simple.ts --outdir ./dist-worker --target bun"

# Environment variables
[vars]
NODE_ENV = "production"

# KV namespace for markets caching
[[kv_namespaces]]
binding = "ORCA_MOCK_CACHE"
id = "272440df0ab0421ea16ca34ec1a6785d"

# Durable Object for WebSocket feed hub
[[durable_objects.bindings]]
name = "ORCA_FEED_HUB"
class_name = "FeedHub"

[durable_objects]
class_name = "FeedHub"

# Migrations for Durable Objects
[[migrations]]
tag = "v1"
new_classes = ["FeedHub"]

# Staging environment
[env.staging]
name = "trader-analyzer-markets-staging"

# Durable Object for staging
[[durable_objects.bindings]]
name = "ORCA_FEED_HUB"
class_name = "FeedHub"

# Production environment (when ready)
[env.production]
name = "trader-analyzer-markets"

# Development settings
[dev]
port = 8788
local_protocol = "http"